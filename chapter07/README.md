# NESTJS
NestJS 는 JS 최신 기능을 사용하는 웹 프레임워크이다.</br>
좋은 구조로 애플리케이션을 작성해 프로젝트의 복잡성을 잘 관리하는 것을 목표로 한다.

### 특징
- Node.js 에서 실행하는 서버 사이드 프레임워크이다.
- 타입스크립트를 완벽하게 지원한다.
- JS 의 최신스펙을 사용한다. 그러므로 바닐라 JS 를 사용하려면 babel 사용이 필수이다.
- HTTP 요청 부분은 추상화된 코드를 제공해 익스프레스와 패스티파이를 사용할 수 있다. (패스트파이: 고성능, 확장성, 스키마기반, 로깅, 개발자 친화적)

서버 개발에 아키텍처가 필요한 이유는, 쉽게 테스트하고 쉽게 확장이 가능하고 각 모듈간의 의존성을 줄이도록 해야 유지보수가 쉽기 때문이다.

NestJS 의 핵심은 의존성 주입이다. 의존성을 주입함으로서 모듈 간의 결합도를 낮춰서 코드의 재사용을 용이하게 하기 때문이다. </br>
즉, 모듈 내에서의 코드의 응집도는 높여서 모듈의 재사용을 꾀하고 모듈 간에는 결합도를 낮춰서 다양한 아키텍처에서 활용할 수 있게 해준다.

NestJS 에서는 HTTP 요청을 보통 파이프 -> 가드 -> 콘트롤러 -> 서비스 -> 리포지토리 순서로 처리한다.</br>
이중 컨트롤러는 필수적이라고 할 수 있다. 클라이언트에서 온 요청을 코드에 전달해야 하기 때문이다.</br>
또한 컨트롤러는 모듈에 포함되어 있으므로 NestJS 를 최소한의 코드로 실행시키려면 하나의 모듈과 하나의 컨트롤러가 필요하다.

### 설치방법
1. NestJS 구동에 필요한 라이브러리들을 모두 수동으로 설치하는 방법
2. nest-cli 패키지를 이용하는 방법. nest 명령어를 사용하여 쉽게 프로젝트를 생성할 수 있다.
3. nest 명령어를 설치하는 저장소를 직접 git clone 하여 개발 디렉터리에 내려받은 후 설정하는 방법

### package-json 구조 설명
- @nestjs/common -> NestJS 의 공통 코드들
- @nestjs/core -> NestJS 의 핵심 코드(가드, 미들웨어, 파이프 등);
- @nestjs/platform-express -> HTTP 요청에 익스프레스 사용
- reflect-metadata -> 데코레이터 사용 시 필수
- typescript -> 타입스크립트 사용 시 필수

### NestJS 네이밍 규칙
1. 파일명은 . 으로 연결한다. 모듈이 둘 이상의 단어로 구성되어 있으면 대시로 연결한다</br>
ex) <모듈명>.<컴포넌트명>.ts => my-first.controller.ts
2. 클래스명은 낙타표기법을 사용한다.</br>
ex) <모듈명><컴포넌트명> => HelloController
3. 같은 디렉터리에 있는 클래스는 index.ts 를 통해서 임포트하는 것을 권장한다.
4. 타입스크립트에서는 인터페이스를 많이 사용하므로, 인터페이스는 타입을 정의하는데 사용되고 구체적인 내용은 클래스를 만들고 인터페이스를 상속받는 방식으로 작성한다.</br>
인터페이스 작명법으로 앞에 I 를 붙이는 방법도 있다. ex) Series 를 ISeries 로 작성</br>
그렇기 때문에 NestJS 에서는 인터페이스를 만들고 그 하위 인터페이스 혹은 클래스를 만든다.</br>
```
 // ex)
 interface Series {}
 interface BookSeries extends Series {}
 class MovieSeries extends Series {}
```

## 개발 프로세스
1. API 만들기 (프로젝트 생성 -> 컨트롤러 생성 -> 블로그 API 작성 -> 메모리와 파일로 블로그 API 만들기)
2. 의존성 주입 (의존성 주입 설정 -> 서비스에 리포지토리 의존성 주입하기 -> 컨트롤러에 서비스 의존성 주입)
3. 몽고디비 연동하기 (의존성 설치 -> 스키마 만들기 -> 몽고디비 리포지토리 생성 -> 서비스에서 몽고디비를 사용하도록 변경)

nest-cli 설치 -> $ npm install -g @nestjs/cli

프로젝트 생성 -> nest new blog

.prettierrc 는 코드 포매팅 관련 설정 파일이다.

nest-cli.json 파일은 nest 명령어를 사용해 프로젝트를 생성하거나 파일을 생성할 때 필요에 따라 수정한다.

app.controller.spec.ts 는 컨트롤러 테스트를 위한 파일이다. NestJS 에서는 jest 와 supertest 를 사용해 테스트한다.

### 컨트롤러 만들기
NestJS 에는 수많은 컴포넌트가 있는데, 그 중 컨트롤러는 유저가 보낸 HTTP 요청을 어떤 코드에서 처리할지 정하는 역할을 한다.

### 유효성 검증
NestJS 에서는 유효성 검증을 파이프를 사용해서 한다. (익스프레스는 별도의 라이브러리 이용)</br>
ValidationPipe 이용 -> class-validator 와 class-transformer 설치 필요
- class-validator: 데코레이터를 사용해 간편하게 유효성 검증을 하는 라이브러리
- class-transformer: JSON 정보를 클래스 객체로 변경한다. 받은 요청을 변환한 클래스가 컨트롤러의 핸들러 메서드의 매개변수에 선언되어 있는 클래스와 같다면, 유효성 검증을 한다.




